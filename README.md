# Pentest-Service-Enumeration

## Purpose
Suggests binaries to run against services found during the enumeration phase of a Pentest

## Background
While studying for the Offensive Security Certified Profesional (OSCP) certification I found it hard to keep track of which commands to run during the enumeration phase for specific services.

The purpose of this tool is easily keep track of those commands.



# Install Instructions
```
git clone https://github.com/ssstonebraker/Pentest-Service-Enumeration
cd Pentest-Service-Enumeration
./install.sh
```

# How to use
```
[Pentest Service Enumeration: 0.0.3]
- Pentest command reference via the cli
----------------------------------------------------------------------------------------------------
Available Services
[*] dns
[*] ftp
[*] hashcat
[*] http
[*] ldap
[*] linpriv
[*] mimikatz
[*] nfs
[*] rpc
[*] searchsploit
[*] smb
[*] smtp
[*] snmp
[*] sql
[*] ssh
[*] sudo
[*] tcpdump
[*] webdav
[*] wfuzz
----------------------------------------------------------------------------------------------------
Return command references for a service
Usage: pse <service-name>

Examples
[*] pse ftp
[*] pse wfuzz
[*] pse smb

----------------------------------------------------------------------------------------------------
Help: pse -h
----------------------------------------------------------------------------------------------------
STORING A NEW COMMAND WITH ARGUMENTS
[-] pse stored service location: /home/kali/.pse
Edit corresponding service file at /home/kali/.pse/<filename> (e.g. /home/kali/.pse/smb or /home/kali/.pse/dns)
If your want to add a new service, create a file in /home/kali/.pse

----------------------------------------------------------------------------------------------------
Example: To create documentation for curl:
1. Create file /home/kali/.pse/curl
2. Add one line per command you want saved in format:
<description>:<command>

Example content for file /home/kali/.pse/curl:
Return help content:curl -h
Run curl in verbose mode:curl -v
```
# Screenshots
# Basic Usage
To view basic usage just type:
```
pse
```
This will list out the available services and give an example of how to use it

![image](https://gist.github.com/ssstonebraker/3b96125491139a84aba408f3a0d4b088/raw/images---Tue_May_26_2020_1590524462791.png)
# Listing commands for a service
```
pse <service-name>
```
## Example:
List commands to run with smb
```
# pse smb

----------------------------------------------------------------------------------------------------
connect to remote smb share as null user
[*] smbclient "//$IP/$SHARE_NAME" -U ""
----------------------------------------------------------------------------------------------------
Create a destination mount directory, mount remote share as guest
[*] sudo mkdir /mnt/$IP_$FOLDER; sudo mount -v -t cifs "//$IP/$FOLDER" /mnt/$IP_$FOLDER -o username=guest
----------------------------------------------------------------------------------------------------
Launch a semi-interactive shell
[*] smbexec.py $HOST/$USERNAME:$PASSWORD@$IP
----------------------------------------------------------------------------------------------------
List smb share files using a null user
[*] smbclient -L $IP -U -N
----------------------------------------------------------------------------------------------------
ngrep samba version while connecting via smbclient
[*] export INTERFACE="tun0"; sudo ngrep -i -d $INTERFACE 's.?a.?m.?b.?a.*[[:digit:]]'
----------------------------------------------------------------------------------------------------
Recursive directory listing
[*] smbmap -H $ip -R
----------------------------------------------------------------------------------------------------
Scan IP Address for SMB Pipe Names
[*] pipef -a $IP
----------------------------------------------------------------------------------------------------
```

# Adding commands for a service
In this example I am adding the dirb command for the https service

```
STORING A NEW COMMAND WITH ARGUMENTS
[-] pse stored service location: /home/kali/.pse
Edit corresponding service file at /home/kali/.pse/<filename> (e.g. /home/kali/.pse/smb or /home/kali/.pse/dns)
If your want to add a new service, create a file in /home/kali/.pse

----------------------------------------------------------------------------------------------------
Example: To create documentation for curl:
1. Create file /home/kali/.pse/curl
2. Add one line per command you want saved in format:
<description>:<command>

Example content for file /home/kali/.pse/curl:
Return help content:curl -h
Run curl in verbose mode:curl -v
```
